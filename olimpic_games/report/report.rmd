---
title: "Analyse of results of olimpic games"
author: "Petrenko Kate"
date: '2022-11-15'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
```

#1. Read data

```{r}

read_all_files <- function(pattern, path) {
  file_list <- list.files(path = path, pattern=pattern, full.names=TRUE)
  
  for (file in file_list) {
    if (!exists('dataset')){
      dataset <- read.csv(file)
    }
    
    if (exists('dataset')){
      temp_df <- read.csv(file)
      dataset <- rbind(dataset, temp_df)
      rm(temp_df)
    }
  }
  return(dataset)
}

dataset <- read_all_files(pattern = '.csv', path = 'data/')
```

#3. The youngest persons

```{r}

young_woman <- dataset %>% 
  filter(., Sex  == 'F') %>% 
  filter(Age == min(Age, na.rm = T))
young_woman
age_of_young_woman <- unique(young_woman$Age)

young_man <- dataset %>% 
  filter(., Sex  == 'M') %>% 
  filter(Age == min(Age, na.rm = T))
young_man
age_of_young_man <- unique(young_man$Age)
```

**Answer #3:** the youngest female athlete - 11 years old, the youngest male athlete - 10 years old

#4. Mean and se of Height

```{r}
mean_height_women <- mean(dataset$Height[dataset$Sex == 'F'], na.rm = T)
mean_height_men <- mean(dataset$Height[dataset$Sex == 'M'], na.rm = T)

sd_height_women <- sd(dataset$Height[dataset$Sex == 'F'], na.rm = T)
sd__height_men <- sd(dataset$Height[dataset$Sex == 'M'], na.rm = T)
```

**Answer #4:** male - 178.5 +- 9.4; female - 167.8 +- 8.8

#5. Mean and se of Height of tennis

```{r}
tennis_2000_women <- dataset %>% 
  filter(Sex == 'F') %>% 
  filter(Year == 2000) %>% 
  filter(Sport == 'Tennis')

mean_ten_women <- round(mean(tennis_2000_women$Height, na.rm = T), 1)
sd_ten_women <- round(sd(tennis_2000_women$Height, na.rm = T), 1)
```

**Answer #5:** mean of Height of female tennis player 171.7 +- 6.3

#6

```{r}
weight_athlet <- dataset %>% 
  filter(Year == 2006) %>% 
  filter(Weight == max(Weight, na.rm = T))

weight_athlet
sport <- unique(weight_athlet$Sport)
sport
```

**Answer #6:** Skeleton #7

```{r}
gold_medals <- dataset %>% 
  filter(Sex == 'F') %>% 
  filter(Year >= 1980 & Year <= 2010) %>% 
  filter(Medal == 'Gold') %>% 
  nrow

gold_medals

  
```

**Answer #7:** 2409 gold medals were won by women from 1980 to 2010

#8

```{r}
games_John <- dataset %>% 
  filter(Name == 'John Aalberg') %>% 
  group_by(Year) %>% 
  summarise(n = n())

games_John
```

**Answer #8:** John Aallberg participated 8 times in 1992 and 8 times in 1994

#9

```{r}
dataset_gr_age <- dataset %>% 
  mutate(
    age_group = dplyr::case_when(
      Age >= 15 & Age < 25 ~ "15-25",
      Age >= 25 & Age < 35 ~ "25-35",
      Age >= 35 & Age < 45 ~ "35-45",
      Age >= 45 & Age <= 55 ~ "45-55"
    ),

    age_group = factor(
      age_group,
      level = c("15-25", "25-35","35-45", "45-55")
    )
  ) %>% 
  filter(Year == 2008) %>% 
  group_by(age_group) %>% 
  summarise(n=n())
  
dataset_gr_age
```

#10

```{r}
spotrs_2002 <- dataset %>% 
  filter(Year == 2002) 

spotrs_1994 <- dataset %>% 
  filter(Year == 1994) 

length(unique(spotrs_2002$Sport)) - length(unique(spotrs_1994$Sport))
```

**Answer #10:** In 2002 there were 3 more sports

#11

```{r}
winter_gold_top3 <- dataset %>% 
  filter(Season == 'Winter', Medal == 'Gold') %>% 
  group_by(NOC) %>% 
  summarise(n=n()) %>% 
  arrange(-n) %>% 
  slice_head(n = 3)

winter_gold_top3
```

```{r}
winter_silver_top3 <- dataset %>% 
  filter(Season == 'Winter', Medal == 'Silver') %>% 
  group_by(NOC) %>% 
  summarise(n=n()) %>% 
  arrange(-n) %>% 
  slice_head(n = 3)

winter_silver_top3
```

```{r}
winter_bronze_top3 <- dataset %>% 
  filter(Season == 'Winter', Medal == 'Bronze') %>% 
  group_by(NOC) %>% 
  summarise(n=n()) %>% 
  arrange(-n) %>% 
  slice_head(n = 3)

winter_bronze_top3
```

```{r}
summer_gold_top3 <- dataset %>% 
  filter(Season == 'Summer', Medal == 'Gold') %>% 
  group_by(NOC) %>% 
  summarise(n=n()) %>% 
  arrange(-n) %>% 
  slice_head(n = 3)

summer_gold_top3
```

```{r}
summer_silver_top3 <- dataset %>% 
  filter(Season == 'Summer', Medal == 'Silver') %>% 
  group_by(NOC) %>% 
  summarise(n=n()) %>% 
  arrange(-n) %>% 
  slice_head(n = 3)

summer_silver_top3
```

```{r}
summer_bronze_top3 <- dataset %>% 
  filter(Season == 'Summer', Medal == 'Bronze') %>% 
  group_by(NOC) %>% 
  summarise(n=n()) %>% 
  arrange(-n) %>% 
  slice_head(n = 3)

summer_bronze_top3
```

#12

```{r}
dataset_z_score <- dataset %>% 
  mutate(Height_z_scores = (Height - mean(Height, na.rm=T))/sd(Height, na.rm=T))
    
head(dataset_z_score)     
```

#13

```{r}
minmax_norm <- function(x) {
    return((x- min(x, na.rm = T)) /(max(x, na.rm = T)-min(x,na.rm = T)))
}

dataset_minmax_norm <- dataset %>% 
  mutate(Height_min_max_scaled = minmax_norm(Height))

head(dataset_minmax_norm)
```
